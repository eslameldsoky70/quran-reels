<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù†ÙˆØ± Ø§Ù„Ø±ÙŠÙ„Ø² ğŸŒ™</title>
<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@300;400;600;700;900&family=Scheherazade+New:wght@400;700&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;overflow:hidden;font-family:'Cairo',sans-serif;background:#070e09;color:#f0ebe1;direction:rtl}
body::before{content:'';position:fixed;inset:0;pointer-events:none;opacity:.035;z-index:0;background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120'%3E%3Cpolygon points='60,3 72,42 110,42 80,65 90,104 60,82 30,104 40,65 10,42 48,42' fill='none' stroke='%23c9973a' stroke-width='1'/%3E%3C/svg%3E")}
.app{display:grid;grid-template-rows:54px 1fr;height:100vh;position:relative;z-index:1}
.main{display:grid;grid-template-columns:280px 1fr 265px;overflow:hidden}
/* TOP */
.top{background:rgba(7,14,9,.98);border-bottom:1px solid rgba(201,151,58,.15);display:flex;align-items:center;padding:0 16px;gap:10px}
.logo{display:flex;align-items:center;gap:9px}
.logo-ball{width:33px;height:33px;border-radius:50%;background:linear-gradient(135deg,#245c38,#3ea066);display:flex;align-items:center;justify-content:center;font-size:16px}
.logo-name{font-family:'Amiri',serif;font-size:19px;color:#e4b55a}
.ttabs{display:flex;gap:4px;margin-right:14px}
.ttab{padding:5px 13px;border-radius:100px;font-size:12px;cursor:pointer;border:1px solid rgba(255,255,255,.07);background:transparent;color:#6e8878;font-family:'Cairo',sans-serif;transition:.2s}
.ttab.on{border-color:rgba(201,151,58,.5);background:rgba(201,151,58,.1);color:#e4b55a}
#statusBar{font-size:11px;padding:3px 12px;border-radius:100px;transition:.3s;margin-right:auto}
.btn-gold{padding:8px 18px;border-radius:8px;border:none;font-family:'Cairo',sans-serif;font-size:13px;font-weight:700;cursor:pointer;background:linear-gradient(135deg,#6b4e18,#c9973a);color:#fff}
/* PANELS */
.panel{background:#0c1810;overflow-y:auto;border:0}
.left{border-left:1px solid rgba(201,151,58,.13)}
.right{border-right:1px solid rgba(201,151,58,.13)}
.psec{padding:13px 14px;border-bottom:1px solid rgba(201,151,58,.1)}
.plbl{font-size:10px;letter-spacing:2px;color:#6e8878;text-transform:uppercase;display:block;margin-bottom:10px}
/* SHEIKH */
.sh-grid{display:grid;grid-template-columns:1fr 1fr;gap:7px}
.sh-card{border:1px solid rgba(201,151,58,.1);border-radius:12px;padding:10px 8px;cursor:pointer;text-align:center;background:#112016;transition:.2s}
.sh-card:hover,.sh-card.on{border-color:rgba(201,151,58,.6);background:rgba(201,151,58,.08)}
.sh-card.on .sh-name{color:#e4b55a}
.sh-flag{font-size:22px;margin-bottom:5px}
.sh-name{font-size:11px;color:#b5c4bc;line-height:1.3;font-weight:600}
.sh-country{font-size:9px;color:#6e8878;margin-top:2px}
/* SURAH */
.s-search{width:100%;background:#18301e;border:1px solid rgba(201,151,58,.15);border-radius:8px;color:#f0ebe1;font-family:'Cairo',sans-serif;font-size:13px;padding:8px 12px;outline:none;margin-bottom:8px}
.s-list{max-height:220px;overflow-y:auto;display:flex;flex-direction:column;gap:3px}
.s-item{display:flex;align-items:center;gap:10px;padding:7px 10px;border-radius:8px;cursor:pointer;border:1px solid transparent;transition:.18s}
.s-item:hover{background:#18301e}
.s-item.on{background:rgba(201,151,58,.08);border-color:rgba(201,151,58,.35)}
.s-num{width:24px;height:24px;border-radius:50%;background:#18301e;border:1px solid rgba(201,151,58,.2);display:flex;align-items:center;justify-content:center;font-size:10px;color:#c9973a;flex-shrink:0}
.s-ar{font-family:'Scheherazade New',serif;font-size:17px;flex:1}
.s-v{font-size:10px;color:#6e8878}
/* VERSE RANGE */
.v-range{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:10px}
.flbl{font-size:10px;color:#6e8878;display:block;margin-bottom:4px}
.finp{width:100%;background:#18301e;border:1px solid rgba(201,151,58,.2);border-radius:8px;color:#f0ebe1;font-family:'Cairo',sans-serif;font-size:15px;padding:8px;outline:none;text-align:center}
.v-list{display:flex;flex-direction:column;gap:5px;max-height:300px;overflow-y:auto}
.v-item{padding:9px 11px;border-radius:10px;cursor:pointer;border:1px solid rgba(255,255,255,.05);background:#112016;transition:.18s;display:flex;gap:8px;align-items:flex-start}
.v-item:hover,.v-item.on{border-color:rgba(201,151,58,.5);background:rgba(201,151,58,.07)}
.v-num{font-size:10px;color:#c9973a;font-weight:700;padding-top:4px;flex-shrink:0}
.v-ar{font-family:'Scheherazade New',serif;font-size:14px;line-height:2;color:#f0ebe1}
.v-en{font-size:9px;color:#6e8878;margin-top:1px;line-height:1.5}
/* BG */
.bg-grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:7px}
.bg-thumb{aspect-ratio:9/16;border-radius:10px;border:2px solid rgba(255,255,255,.07);cursor:pointer;display:flex;flex-direction:column;align-items:center;justify-content:center;transition:.2s;font-size:20px}
.bg-thumb.on{border-color:#c9973a;box-shadow:0 0 14px rgba(201,151,58,.3)}
.bg-lbl{font-size:9px;color:#b5c4bc;margin-top:4px}
/* CENTER */
.center{background:#070e09;display:flex;flex-direction:column;overflow:hidden}
.stage-bar{padding:8px 16px;border-bottom:1px solid rgba(201,151,58,.1);display:flex;align-items:center;gap:8px;background:rgba(7,14,9,.8);flex-shrink:0}
.pos-btn{padding:4px 14px;border-radius:100px;font-size:12px;border:1px solid rgba(255,255,255,.07);background:transparent;color:#6e8878;cursor:pointer;font-family:'Cairo',sans-serif;transition:.2s}
.pos-btn.on{border-color:rgba(201,151,58,.5);background:rgba(201,151,58,.1);color:#e4b55a}
.stage{flex:1;display:flex;align-items:center;justify-content:center;padding:24px;overflow:hidden;position:relative}
/* PHONE */
.phone{width:252px;height:448px;border-radius:40px;border:2px solid rgba(255,255,255,.1);background:#000;box-shadow:0 40px 80px rgba(0,0,0,.85),0 0 50px rgba(36,92,56,.22);position:relative;overflow:hidden;flex-shrink:0}
.screen{position:absolute;inset:7px;border-radius:35px;overflow:hidden}
.s-geo{position:absolute;inset:0;opacity:.04;background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='70' height='70'%3E%3Ccircle cx='35' cy='35' r='30' fill='none' stroke='%23c9973a' stroke-width='.7'/%3E%3C/svg%3E")}
.s-glow{position:absolute;inset:0;background:radial-gradient(ellipse at 50% 45%,rgba(36,92,56,.28),transparent 70%);pointer-events:none}
.s-moon{position:absolute;top:13px;width:100%;text-align:center;font-size:19px;opacity:.75;animation:float 3.5s ease-in-out infinite}
.s-basmala{position:absolute;top:42px;width:100%;text-align:center;font-family:'Scheherazade New',serif;font-size:11px;color:rgba(200,160,50,.85)}
.s-line{position:absolute;right:16px;left:16px;height:1px;background:linear-gradient(to left,transparent,rgba(200,160,50,.4),transparent)}
.s-verse{position:absolute;right:12px;left:12px;z-index:2;text-align:center;transition:.3s}
.v-ara{line-height:2.1;text-shadow:0 2px 14px rgba(0,0,0,.95);direction:rtl}
.v-ref{margin-top:7px;font-size:9.5px;color:rgba(200,160,50,.9);font-family:'Cairo',sans-serif}
.v-eng{margin-top:5px;font-size:9px;color:rgba(180,200,190,.8);line-height:1.65;direction:ltr}
.s-info{position:absolute;width:100%;text-align:center;font-family:'Cairo',sans-serif}
.play-dot{position:absolute;top:12px;right:12px;width:8px;height:8px;border-radius:50%;background:#5ec285;box-shadow:0 0 6px #5ec285;animation:twinkle 1s ease-in-out infinite;display:none}
/* PLAYER */
.player{background:#0c1810;border-top:1px solid rgba(201,151,58,.12);padding:12px 20px;flex-shrink:0}
.player-top{display:flex;align-items:center;gap:12px;margin-bottom:9px}
.pbtn{border-radius:50%;border:1px solid rgba(201,151,58,.18);background:#18301e;color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:.2s}
.pbtn-main{width:44px;height:44px;border:none;font-size:19px;background:linear-gradient(135deg,#245c38,#3ea066);box-shadow:0 4px 14px rgba(36,92,56,.45)}
.pbtn-sm{width:34px;height:34px;font-size:13px}
.prog-row{display:flex;align-items:center;gap:10px}
.prog-bar{flex:1;height:5px;background:#18301e;border-radius:100px;cursor:pointer;position:relative;overflow:visible}
.prog-fill{height:100%;background:linear-gradient(to right,#c9973a,#e4b55a);border-radius:100px;width:0%;transition:.1s}
.prog-dot{width:13px;height:13px;border-radius:50%;background:#e4b55a;position:absolute;top:-4px;left:0%;box-shadow:0 0 8px rgba(201,151,58,.6);pointer-events:none;transform:translateX(-50%)}
/* RIGHT */
.font-btn{width:100%;padding:9px 12px;border:1px solid rgba(255,255,255,.06);border-radius:8px;background:#112016;cursor:pointer;font-size:15px;color:#b5c4bc;margin-bottom:6px;transition:.2s;direction:rtl;text-align:right;font-family:inherit}
.font-btn:hover,.font-btn.on{border-color:rgba(201,151,58,.5);color:#f0ebe1;background:rgba(201,151,58,.07)}
.sz-btns{display:flex;gap:5px;flex-wrap:wrap;margin-top:8px}
.sz-btn{padding:3px 9px;font-size:11px;border-radius:6px;border:1px solid rgba(255,255,255,.07);background:transparent;color:#6e8878;cursor:pointer;font-family:'Cairo',sans-serif;transition:.2s}
.sz-btn:hover,.sz-btn.on{border-color:rgba(201,151,58,.5);background:rgba(201,151,58,.1);color:#e4b55a}
.clr-dot{width:28px;height:28px;border-radius:50%;cursor:pointer;border:2.5px solid transparent;transition:.18s}
.clr-dot.on{border-color:#fff;transform:scale(1.18);box-shadow:0 0 8px rgba(255,255,255,.35)}
.sw-row{display:flex;align-items:center;justify-content:space-between;padding:9px 0;cursor:pointer;border-bottom:1px solid rgba(255,255,255,.04)}
.sw{width:38px;height:21px;border-radius:100px;position:relative;transition:.25s;flex-shrink:0}
.sw-k{width:15px;height:15px;border-radius:50%;background:#fff;position:absolute;top:3px;transition:.25s}
/* TOAST */
.toast{position:fixed;bottom:22px;left:50%;transform:translateX(-50%) translateY(100px);background:#0c1810;border:1px solid rgba(201,151,58,.6);padding:10px 28px;border-radius:100px;font-size:13px;color:#e4b55a;z-index:9999;white-space:nowrap;box-shadow:0 8px 30px rgba(0,0,0,.6);transition:.35s;pointer-events:none}
.toast.show{transform:translateX(-50%) translateY(0)}
/* EXPORT */
.exp-fill{height:100%;background:linear-gradient(to right,#c9973a,#e4b55a);border-radius:100px;width:0%;transition:.15s}
/* SCROLLBAR */
::-webkit-scrollbar{width:4px}::-webkit-scrollbar-track{background:#0c1810}::-webkit-scrollbar-thumb{background:#245c38;border-radius:2px}
/* ANIMATIONS */
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-7px)}}
@keyframes twinkle{0%,100%{opacity:.3}50%{opacity:1}}
input[type=range]{-webkit-appearance:none;width:100%;height:4px;border-radius:2px;background:#18301e;outline:none;border:none;cursor:pointer}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:16px;height:16px;border-radius:50%;background:#3ea066;cursor:pointer;box-shadow:0 0 8px rgba(62,160,102,.5)}
</style>
</head>
<body>
<div class="app">

<!-- TOPBAR -->
<div class="top">
  <div class="logo">
    <div class="logo-ball">ğŸŒ™</div>
    <span class="logo-name">Ù†ÙˆØ± Ø§Ù„Ø±ÙŠÙ„Ø²</span>
  </div>
  <div class="ttabs">
    <div class="ttab on" onclick="switchTab('sheikh')">ğŸ™ Ø§Ù„Ø´ÙŠÙˆØ®</div>
    <div class="ttab"    onclick="switchTab('surah')">ğŸ“– Ø§Ù„Ø³ÙˆØ±</div>
    <div class="ttab"    onclick="switchTab('bg')">ğŸ–¼ Ø§Ù„Ø®Ù„ÙÙŠØ§Øª</div>
  </div>
  <div id="statusBar" style="margin-right:auto;font-size:11px;color:#6e8878"></div>
  <button class="btn-gold" onclick="startExport()">â¬‡ ØªØµØ¯ÙŠØ± HD</button>
</div>

<!-- MAIN -->
<div class="main">

<!-- LEFT -->
<div class="panel left">
  <div id="tab-sheikh">
    <div class="psec">
      <span class="plbl">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø§Ø±Ø¦</span>
      <div class="sh-grid" id="shGrid"></div>
    </div>
  </div>
  <div id="tab-surah" style="display:none">
    <div class="psec">
      <span class="plbl">Ø§Ø®ØªØ± Ø§Ù„Ø³ÙˆØ±Ø©</span>
      <input class="s-search" type="text" placeholder="Ø§Ø¨Ø­Ø«..." oninput="filterSurahs(this.value)">
      <div class="s-list" id="surahList"></div>
    </div>
    <div class="psec">
      <span class="plbl">Ù†Ø·Ø§Ù‚ Ø§Ù„Ø¢ÙŠØ§Øª</span>
      <div class="v-range">
        <div><span class="flbl">Ø¢ÙŠØ© Ù…Ù†</span><input class="finp" type="number" id="vFrom" value="1" min="1" onchange="rangeChanged()"></div>
        <div><span class="flbl">Ø¢ÙŠØ© Ø¥Ù„Ù‰</span><input class="finp" type="number" id="vTo"   value="7" min="1" onchange="rangeChanged()"></div>
      </div>
      <button onclick="togglePlay()" style="width:100%;padding:10px;background:linear-gradient(135deg,#245c38,#3ea066);border:none;border-radius:8px;color:#fff;font-family:'Cairo',sans-serif;font-size:13px;font-weight:700;cursor:pointer">â–¶ ØªØ´ØºÙŠÙ„</button>
    </div>
    <div class="psec">
      <span class="plbl">Ø§Ù„Ø¢ÙŠØ§Øª</span>
      <div class="v-list" id="vList"></div>
    </div>
  </div>
  <div id="tab-bg" style="display:none">
    <div class="psec">
      <span class="plbl">Ø§Ø®ØªØ± Ø§Ù„Ø®Ù„ÙÙŠØ©</span>
      <div class="bg-grid" id="bgGrid"></div>
    </div>
  </div>
</div>

<!-- CENTER -->
<div class="center">
  <div class="stage-bar">
    <span style="font-size:11px;color:#6e8878">Ù…ÙˆØ¶Ø¹ Ø§Ù„Ù†Øµ:</span>
    <button class="pos-btn"    onclick="setPos(this,'top')">â†‘</button>
    <button class="pos-btn on" onclick="setPos(this,'center')">âŠ™</button>
    <button class="pos-btn"    onclick="setPos(this,'bottom')">â†“</button>
    <span style="margin-right:auto;font-size:10px;color:#6e8878">Ù…Ø¹Ø§ÙŠÙ†Ø© Ù…Ø¨Ø§Ø´Ø±Ø© Â· 9:16</span>
  </div>
  <div class="stage">
    <div style="position:absolute;width:500px;height:500px;border-radius:50%;background:radial-gradient(ellipse,rgba(36,92,56,.14),transparent 70%);pointer-events:none"></div>
    <div class="phone">
      <div class="screen" id="screen" style="background:linear-gradient(160deg,#020d04,#071a0a)">
        <div class="s-geo"></div>
        <div class="s-glow" id="elGlow"></div>
        <div id="elStars">
          <div style="position:absolute;top:16px;left:16px;font-size:9px;color:rgba(200,160,50,.7);animation:twinkle 2s ease-in-out infinite;line-height:1">âœ¦</div>
          <div style="position:absolute;top:20px;left:220px;font-size:8px;color:rgba(200,160,50,.5);animation:twinkle 2.5s ease-in-out infinite .5s;line-height:1">âœ¦</div>
          <div style="position:absolute;top:50px;left:16px;font-size:7px;color:rgba(200,160,50,.4);animation:twinkle 3s ease-in-out infinite 1s;line-height:1">âœ¦</div>
        </div>
        <div class="s-moon" id="elMoon">ğŸŒ™</div>
        <div class="s-basmala">Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø§Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ†Ù Ø§Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù</div>
        <div class="s-line" style="top:58px"></div>
        <div class="s-verse" id="verseArea" style="top:50%;transform:translateY(-50%)">
          <div class="v-ara" id="vAr" style="font-family:'Scheherazade New',serif;font-size:26px;color:#fff">Ø¨ÙØ³Ù’Ù…Ù Ù±Ù„Ù„ÙÙ‘Ù‡Ù Ù±Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ€Ù°Ù†Ù Ù±Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù</div>
          <div class="v-ref" id="vRef">ï´¿ Ø§Ù„ÙØ§ØªØ­Ø© : Ù¡ ï´¾</div>
          <div class="v-eng" id="vEn">In the name of Allah, the Most Gracious.</div>
        </div>
        <div class="s-line" style="bottom:48px"></div>
        <div class="s-info" id="elSheikh" style="bottom:32px;font-size:8.5px;color:rgba(140,190,160,.6)"></div>
        <div class="s-info" id="elWm"     style="bottom:12px;font-size:8.5px;color:rgba(255,255,255,.3)"></div>
        <div class="play-dot" id="playDot"></div>
      </div>
    </div>
  </div>

  <!-- PLAYER -->
  <div class="player">
    <div class="player-top">
      <div style="flex:1;min-width:0">
        <div id="npTitle" style="font-size:13px;font-weight:600">Ø§Ù„ÙØ§ØªØ­Ø© â€” Ø¢ÙŠØ© Ù¡</div>
        <div id="npSub"   style="font-size:11px;color:#6e8878;margin-top:2px">Ø§Ø®ØªØ± Ø´ÙŠØ®Ø§Ù‹ Ù„Ù„Ø¨Ø¯Ø¡</div>
      </div>
      <div style="display:flex;gap:6px;align-items:center;flex-shrink:0">
        <button class="pbtn pbtn-sm" onclick="seekRel(-10)">â®</button>
        <button class="pbtn pbtn-main" id="mainBtn" onclick="togglePlay()">â–¶</button>
        <button class="pbtn pbtn-sm" onclick="seekRel(10)">â­</button>
      </div>
    </div>
    <div class="prog-row">
      <span id="tCur" style="font-size:11px;color:#6e8878;min-width:32px">0:00</span>
      <div class="prog-bar" id="progBar" onclick="seekClick(event)">
        <div class="prog-fill" id="pFill"></div>
        <div class="prog-dot"  id="pDot"></div>
      </div>
      <span id="tDur" style="font-size:11px;color:#6e8878;min-width:32px;text-align:left">0:00</span>
    </div>
  </div>
</div>

<!-- RIGHT -->
<div class="panel right">
  <div class="psec">
    <span class="plbl">Ù†Ù…Ø· Ø§Ù„Ø®Ø·</span>
    <button class="font-btn on" style="font-family:'Scheherazade New',serif" onclick="setFont(this,'scheherazade')">Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù â€” Ø¹Ø«Ù…Ø§Ù†ÙŠ</button>
    <button class="font-btn"    style="font-family:'Amiri',serif"            onclick="setFont(this,'amiri')">Ø¨Ø³Ù… Ø§Ù„Ù„Ù‡ â€” Ø£Ù…ÙŠØ±ÙŠ</button>
    <button class="font-btn"    style="font-family:'Cairo',sans-serif"       onclick="setFont(this,'cairo')">Ø¨Ø³Ù… Ø§Ù„Ù„Ù‡ â€” ÙƒØ§ÙŠØ±Ùˆ</button>
  </div>
  <div class="psec">
    <span class="plbl">Ø­Ø¬Ù… Ø§Ù„Ø®Ø· â€” <span id="fsLbl">26</span>px</span>
    <input id="fsRange" type="range" min="16" max="54" value="26" oninput="setSize(+this.value)">
    <div class="sz-btns">
      <button class="sz-btn" onclick="setSize(18)">18</button>
      <button class="sz-btn" onclick="setSize(22)">22</button>
      <button class="sz-btn on" onclick="setSize(26)">26</button>
      <button class="sz-btn" onclick="setSize(30)">30</button>
      <button class="sz-btn" onclick="setSize(36)">36</button>
      <button class="sz-btn" onclick="setSize(44)">44</button>
      <button class="sz-btn" onclick="setSize(52)">52</button>
    </div>
  </div>
  <div class="psec">
    <span class="plbl">Ù„ÙˆÙ† Ø§Ù„Ù†Øµ</span>
    <div style="display:flex;gap:7px;flex-wrap:wrap">
      <div class="clr-dot on" style="background:#ffffff" onclick="setColor('#ffffff',this)"></div>
      <div class="clr-dot"    style="background:#f5d990" onclick="setColor('#f5d990',this)"></div>
      <div class="clr-dot"    style="background:#c9973a" onclick="setColor('#c9973a',this)"></div>
      <div class="clr-dot"    style="background:#9ddbb8" onclick="setColor('#9ddbb8',this)"></div>
      <div class="clr-dot"    style="background:#aecbd8" onclick="setColor('#aecbd8',this)"></div>
      <div class="clr-dot"    style="background:#f4c4c4" onclick="setColor('#f4c4c4',this)"></div>
    </div>
  </div>
  <div class="psec">
    <span class="plbl">Ø§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª</span>
    <div class="sw-row" onclick="toggleFx('moon')">  <span style="font-size:13px;color:#b5c4bc">ğŸŒ™ Ù‡Ù„Ø§Ù„ Ù…ØªØ­Ø±Ùƒ</span>   <div class="sw" id="sw-moon"  style="background:linear-gradient(135deg,#245c38,#3ea066);border:1px solid rgba(62,160,102,.4)"><div class="sw-k" id="sk-moon"  style="right:3px"></div></div></div>
    <div class="sw-row" onclick="toggleFx('stars')"> <span style="font-size:13px;color:#b5c4bc">âœ¦ Ù†Ø¬ÙˆÙ… Ù„Ø§Ù…Ø¹Ø©</span>   <div class="sw" id="sw-stars" style="background:linear-gradient(135deg,#245c38,#3ea066);border:1px solid rgba(62,160,102,.4)"><div class="sw-k" id="sk-stars" style="right:3px"></div></div></div>
    <div class="sw-row" onclick="toggleFx('glow')">  <span style="font-size:13px;color:#b5c4bc">ğŸŒŸ Ù‡Ø§Ù„Ø© Ù†ÙˆØ±Ø§Ù†ÙŠØ©</span> <div class="sw" id="sw-glow"  style="background:linear-gradient(135deg,#245c38,#3ea066);border:1px solid rgba(62,160,102,.4)"><div class="sw-k" id="sk-glow"  style="right:3px"></div></div></div>
    <div class="sw-row" onclick="toggleFx('trans')"> <span style="font-size:13px;color:#b5c4bc">ğŸŒ Ø§Ù„ØªØ±Ø¬Ù…Ø©</span>      <div class="sw" id="sw-trans" style="background:linear-gradient(135deg,#245c38,#3ea066);border:1px solid rgba(62,160,102,.4)"><div class="sw-k" id="sk-trans" style="right:3px"></div></div></div>
  </div>
  <div class="psec">
    <span class="plbl">Ø¹Ù„Ø§Ù…Ø© Ù…Ø§Ø¦ÙŠØ©</span>
    <input type="text" placeholder="@Ù‚Ù†Ø§ØªÙƒ" oninput="document.getElementById('elWm').textContent=this.value" style="width:100%;background:#18301e;border:1px solid rgba(201,151,58,.15);border-radius:8px;color:#f0ebe1;font-family:'Cairo',sans-serif;font-size:13px;padding:9px 12px;outline:none">
  </div>
  <div class="psec">
    <span class="plbl">Ø§Ù„ØªØµØ¯ÙŠØ±</span>
    <div style="display:flex;gap:5px;margin-bottom:10px">
      <div style="flex:1;padding:6px 4px;text-align:center;font-size:9.5px;border:1px solid rgba(201,151,58,.45);border-radius:8px;cursor:pointer;color:#e4b55a;background:rgba(201,151,58,.08);line-height:1.5">ğŸ“± 9:16</div>
      <div style="flex:1;padding:6px 4px;text-align:center;font-size:9.5px;border:1px solid rgba(255,255,255,.07);border-radius:8px;cursor:pointer;color:#6e8878;line-height:1.5">ğŸ¬ ØªÙŠÙƒ ØªÙˆÙƒ</div>
      <div style="flex:1;padding:6px 4px;text-align:center;font-size:9.5px;border:1px solid rgba(255,255,255,.07);border-radius:8px;cursor:pointer;color:#6e8878;line-height:1.5">ğŸ“º 16:9</div>
    </div>
    <button onclick="startExport()" style="width:100%;padding:13px;background:linear-gradient(135deg,#6b4e18,#c9973a);border:none;border-radius:12px;color:#fff;font-family:'Cairo',sans-serif;font-size:15px;font-weight:700;cursor:pointer;box-shadow:0 4px 20px rgba(201,151,58,.35)">âš¡ ØªØµØ¯ÙŠØ± Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</button>
    <div id="expBox" style="display:none;margin-top:10px">
      <div style="height:5px;background:#18301e;border-radius:100px;overflow:hidden"><div class="exp-fill" id="expFill"></div></div>
      <div style="display:flex;justify-content:space-between;font-size:11px;color:#6e8878;margin-top:4px"><span id="expMsg">Ø¬Ø§Ø±Ù Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...</span><span id="expPct" style="color:#e4b55a">0%</span></div>
    </div>
  </div>
</div>

</div><!-- /main -->
</div><!-- /app -->

<div class="toast" id="toast"></div>
<audio id="audio" preload="none" crossorigin="anonymous"></audio>

<script>
/* â•â•â•â•â•â•â• DATA â•â•â•â•â•â•â• */
// mp3quran.net â€” Ø³ÙˆØ± ÙƒØ§Ù…Ù„Ø©ØŒ Ù…ÙˆØ«ÙˆÙ‚Ø©ØŒ Ø¨Ø¯ÙˆÙ† CORS Ù…Ø´Ø§ÙƒÙ„
const SHUYUKH=[
  {server:"https://server8.mp3quran.net/afs/",     name:"Ù…Ø´Ø§Ø±ÙŠ Ø§Ù„Ø¹ÙØ§Ø³ÙŠ",     flag:"ğŸ‡°ğŸ‡¼", country:"Ø§Ù„ÙƒÙˆÙŠØª"},
  {server:"https://server8.mp3quran.net/maher/",   name:"Ù…Ø§Ù‡Ø± Ø§Ù„Ù…Ø¹ÙŠÙ‚Ù„ÙŠ",     flag:"ğŸ‡¸ğŸ‡¦", country:"Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©"},
  {server:"https://server11.mp3quran.net/sds/",    name:"Ø¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù† Ø§Ù„Ø³Ø¯ÙŠØ³",  flag:"ğŸ‡¸ğŸ‡¦", country:"Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©"},
  {server:"https://server8.mp3quran.net/husary/",  name:"Ù…Ø­Ù…ÙˆØ¯ Ø§Ù„Ø­ØµØ±ÙŠ",      flag:"ğŸ‡ªğŸ‡¬", country:"Ù…ØµØ±"},
  {server:"https://server8.mp3quran.net/basit_mujawwad/", name:"Ø¹Ø¨Ø¯ Ø§Ù„Ø¨Ø§Ø³Ø· Ù…Ø¬ÙˆÙ‘Ø¯", flag:"ğŸ‡ªğŸ‡¬", country:"Ù…ØµØ±"},
  {server:"https://server8.mp3quran.net/minshawy_murattal/", name:"Ù…Ø­Ù…Ø¯ Ø§Ù„Ù…Ù†Ø´Ø§ÙˆÙŠ", flag:"ğŸ‡ªğŸ‡¬", country:"Ù…ØµØ±"},
  {server:"https://server8.mp3quran.net/abu_bakr/",name:"Ø£Ø¨Ùˆ Ø¨ÙƒØ± Ø§Ù„Ø´Ø§Ø·Ø±ÙŠ",  flag:"ğŸ‡©ğŸ‡¿", country:"Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±"},
  {server:"https://server7.mp3quran.net/shuraym/", name:"Ø³Ø¹ÙˆØ¯ Ø§Ù„Ø´Ø±ÙŠÙ…",       flag:"ğŸ‡¸ğŸ‡¦", country:"Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©"},
];

const SURAHS=[
  {n:1,ar:"Ø§Ù„ÙØ§ØªØ­Ø©",v:7},{n:2,ar:"Ø§Ù„Ø¨Ù‚Ø±Ø©",v:286},{n:3,ar:"Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†",v:200},
  {n:18,ar:"Ø§Ù„ÙƒÙ‡Ù",v:110},{n:19,ar:"Ù…Ø±ÙŠÙ…",v:98},{n:36,ar:"ÙŠØ³",v:83},
  {n:55,ar:"Ø§Ù„Ø±Ø­Ù…Ù†",v:78},{n:56,ar:"Ø§Ù„ÙˆØ§Ù‚Ø¹Ø©",v:96},{n:67,ar:"Ø§Ù„Ù…Ù„Ùƒ",v:30},
  {n:78,ar:"Ø§Ù„Ù†Ø¨Ø£",v:40},{n:93,ar:"Ø§Ù„Ø¶Ø­Ù‰",v:11},{n:94,ar:"Ø§Ù„Ø´Ø±Ø­",v:8},
  {n:97,ar:"Ø§Ù„Ù‚Ø¯Ø±",v:5},{n:112,ar:"Ø§Ù„Ø¥Ø®Ù„Ø§Øµ",v:4},{n:113,ar:"Ø§Ù„ÙÙ„Ù‚",v:5},{n:114,ar:"Ø§Ù„Ù†Ø§Ø³",v:6},
];

const VERSES={
  1:[{ar:"Ø¨ÙØ³Ù’Ù…Ù Ù±Ù„Ù„ÙÙ‘Ù‡Ù Ù±Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ€Ù°Ù†Ù Ù±Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù",en:"In the name of Allah, the Most Gracious."},{ar:"Ù±Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„ÙÙ‘Ù‡Ù Ø±ÙØ¨ÙÙ‘ Ù±Ù„Ù’Ø¹ÙÙ€Ù°Ù„ÙÙ…ÙÙŠÙ†Ù",en:"All praise is due to Allah, Lord of the worlds."},{ar:"Ù±Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ€Ù°Ù†Ù Ù±Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù",en:"The Most Gracious, the Most Merciful."},{ar:"Ù…ÙÙ€Ù°Ù„ÙÙƒÙ ÙŠÙÙˆÙ’Ù…Ù Ù±Ù„Ø¯ÙÙ‘ÙŠÙ†Ù",en:"Master of the Day of Judgment."},{ar:"Ø¥ÙÙŠÙÙ‘Ø§ÙƒÙ Ù†ÙØ¹Ù’Ø¨ÙØ¯Ù ÙˆÙØ¥ÙÙŠÙÙ‘Ø§ÙƒÙ Ù†ÙØ³Ù’ØªÙØ¹ÙÙŠÙ†Ù",en:"You alone we worship and ask for help."},{ar:"Ù±Ù‡Ù’Ø¯ÙÙ†ÙØ§ Ù±Ù„ØµÙÙ‘Ø±ÙÙ°Ø·Ù Ù±Ù„Ù’Ù…ÙØ³Ù’ØªÙÙ‚ÙÙŠÙ…Ù",en:"Guide us to the straight path."},{ar:"ØµÙØ±ÙÙ°Ø·Ù Ù±Ù„ÙÙ‘Ø°ÙÙŠÙ†Ù Ø£ÙÙ†Ù’Ø¹ÙÙ…Ù’ØªÙ Ø¹ÙÙ„ÙÙŠÙ’Ù‡ÙÙ…Ù’",en:"The path of those You have blessed."}],
  55:[{ar:"Ù±Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ€Ù°Ù†Ù",en:"The Most Merciful."},{ar:"Ø¹ÙÙ„ÙÙ‘Ù…Ù Ù±Ù„Ù’Ù‚ÙØ±Ù’Ø¡ÙØ§Ù†Ù",en:"Taught the Quran."},{ar:"Ø®ÙÙ„ÙÙ‚Ù Ù±Ù„Ù’Ø¥ÙÙ†Ø³ÙÙ€Ù°Ù†Ù",en:"Created man."},{ar:"Ø¹ÙÙ„ÙÙ‘Ù…ÙÙ‡Ù Ù±Ù„Ù’Ø¨ÙÙŠÙØ§Ù†Ù",en:"Taught him eloquence."},{ar:"ÙÙØ¨ÙØ£ÙÙ‰ÙÙ‘ Ø¡ÙØ§Ù„ÙØ¢Ø¡Ù Ø±ÙØ¨ÙÙ‘ÙƒÙÙ…ÙØ§ ØªÙÙƒÙØ°ÙÙ‘Ø¨ÙØ§Ù†Ù",en:"Which of your Lord's favors would you deny?"}],
  112:[{ar:"Ù‚ÙÙ„Ù’ Ù‡ÙÙˆÙ Ù±Ù„Ù„ÙÙ‘Ù‡Ù Ø£ÙØ­ÙØ¯ÙŒ",en:"Say: He is Allah, the One."},{ar:"Ù±Ù„Ù„ÙÙ‘Ù‡Ù Ù±Ù„ØµÙÙ‘Ù…ÙØ¯Ù",en:"Allah, the Eternal Refuge."},{ar:"Ù„ÙÙ…Ù’ ÙŠÙÙ„ÙØ¯Ù’ ÙˆÙÙ„ÙÙ…Ù’ ÙŠÙÙˆÙ„ÙØ¯Ù’",en:"He neither begets nor is born."},{ar:"ÙˆÙÙ„ÙÙ…Ù’ ÙŠÙÙƒÙÙ† Ù„ÙÙ‘Ù‡ÙÛ¥ ÙƒÙÙÙÙˆÙ‹Ø§ Ø£ÙØ­ÙØ¯ÙŒÛ¢",en:"Nor is there any equal to Him."}],
  97:[{ar:"Ø¥ÙÙ†ÙÙ‘Ø¢ Ø£ÙÙ†Ø²ÙÙ„Ù’Ù†ÙÙ€Ù°Ù‡Ù ÙÙÙ‰ Ù„ÙÙŠÙ’Ù„ÙØ©Ù Ù±Ù„Ù’Ù‚ÙØ¯Ù’Ø±Ù",en:"We sent it down on the Night of Decree."},{ar:"Ù„ÙÙŠÙ’Ù„ÙØ©Ù Ù±Ù„Ù’Ù‚ÙØ¯Ù’Ø±Ù Ø®ÙÙŠÙ’Ø±ÙŒ Ù…ÙÙ‘Ù†Ù’ Ø£ÙÙ„Ù’ÙÙ Ø´ÙÙ‡Ù’Ø±Ù",en:"Better than a thousand months."},{ar:"Ø³ÙÙ„ÙÙ€Ù°Ù…ÙŒ Ù‡ÙÙ‰Ù Ø­ÙØªÙÙ‘Ù‰Ù° Ù…ÙØ·Ù’Ù„ÙØ¹Ù Ù±Ù„Ù’ÙÙØ¬Ù’Ø±Ù",en:"Peace until the emergence of dawn."}],
  93:[{ar:"ÙˆÙÙ±Ù„Ø¶ÙÙ‘Ø­ÙÙ‰Ù°",en:"By the morning brightness."},{ar:"Ù…ÙØ§ ÙˆÙØ¯ÙÙ‘Ø¹ÙÙƒÙ Ø±ÙØ¨ÙÙ‘ÙƒÙ ÙˆÙÙ…ÙØ§ Ù‚ÙÙ„ÙÙ‰Ù°",en:"Your Lord has not forsaken you."},{ar:"ÙˆÙÙ„ÙØ³ÙÙˆÙ’ÙÙ ÙŠÙØ¹Ù’Ø·ÙÙŠÙƒÙ Ø±ÙØ¨ÙÙ‘ÙƒÙ ÙÙØªÙØ±Ù’Ø¶ÙÙ‰Ù°",en:"Your Lord will give and you will be satisfied."}],
  94:[{ar:"Ø£ÙÙ„ÙÙ…Ù’ Ù†ÙØ´Ù’Ø±ÙØ­Ù’ Ù„ÙÙƒÙ ØµÙØ¯Ù’Ø±ÙÙƒÙ",en:"Did We not expand your heart?"},{ar:"ÙÙØ¥ÙÙ†ÙÙ‘ Ù…ÙØ¹Ù Ù±Ù„Ù’Ø¹ÙØ³Ù’Ø±Ù ÙŠÙØ³Ù’Ø±Ù‹Ø§",en:"Indeed, with hardship comes ease."},{ar:"Ø¥ÙÙ†ÙÙ‘ Ù…ÙØ¹Ù Ù±Ù„Ù’Ø¹ÙØ³Ù’Ø±Ù ÙŠÙØ³Ù’Ø±Ù‹Ø§",en:"Indeed, with hardship comes ease."},{ar:"ÙˆÙØ¥ÙÙ„ÙÙ‰Ù° Ø±ÙØ¨ÙÙ‘ÙƒÙ ÙÙÙ±Ø±Ù’ØºÙØ¨",en:"To your Lord direct your longing."}],
  67:[{ar:"ØªÙØ¨ÙÙ€Ù°Ø±ÙÙƒÙ Ù±Ù„ÙÙ‘Ø°ÙÙ‰ Ø¨ÙÙŠÙØ¯ÙÙ‡Ù Ù±Ù„Ù’Ù…ÙÙ„Ù’ÙƒÙ",en:"Blessed is He in whose hand is dominion."},{ar:"Ù±Ù„ÙÙ‘Ø°ÙÙ‰ Ø®ÙÙ„ÙÙ‚Ù Ù±Ù„Ù’Ù…ÙÙˆÙ’ØªÙ ÙˆÙÙ±Ù„Ù’Ø­ÙÙŠÙÙˆÙ°Ø©Ù",en:"Who created death and life to test you."}],
  114:[{ar:"Ù‚ÙÙ„Ù’ Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙØ±ÙØ¨ÙÙ‘ Ù±Ù„Ù†ÙÙ‘Ø§Ø³Ù",en:"Say: I seek refuge in the Lord of mankind."},{ar:"Ù…ÙÙ„ÙÙƒÙ Ù±Ù„Ù†ÙÙ‘Ø§Ø³Ù",en:"The Sovereign of mankind."},{ar:"Ù…ÙÙ† Ø´ÙØ±ÙÙ‘ Ù±Ù„Ù’ÙˆÙØ³Ù’ÙˆÙØ§Ø³Ù Ù±Ù„Ù’Ø®ÙÙ†ÙÙ‘Ø§Ø³Ù",en:"From the evil of the whisperer."}],
  113:[{ar:"Ù‚ÙÙ„Ù’ Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙØ±ÙØ¨ÙÙ‘ Ù±Ù„Ù’ÙÙÙ„ÙÙ‚Ù",en:"Say: I seek refuge in the Lord of daybreak."},{ar:"Ù…ÙÙ† Ø´ÙØ±ÙÙ‘ Ù…ÙØ§ Ø®ÙÙ„ÙÙ‚Ù",en:"From the evil of what He created."},{ar:"ÙˆÙÙ…ÙÙ† Ø´ÙØ±ÙÙ‘ Ø­ÙØ§Ø³ÙØ¯Ù Ø¥ÙØ°ÙØ§ Ø­ÙØ³ÙØ¯Ù",en:"From the evil of an envier."}],
};

const BGS=[
  {l:"Ù…Ø³Ø¬Ø¯",e:"ğŸ•Œ",g:"linear-gradient(160deg,#020d04,#071a0a)"},
  {l:"Ø§Ù„ÙƒØ¹Ø¨Ø©",e:"ğŸ•‹",g:"linear-gradient(160deg,#050510,#0d0d22)"},
  {l:"Ù„ÙŠÙ„",e:"ğŸŒ™",g:"linear-gradient(160deg,#02030e,#060820)"},
  {l:"Ø·Ø¨ÙŠØ¹Ø©",e:"ğŸŒ¿",g:"linear-gradient(160deg,#020a02,#071407)"},
  {l:"ØºØ±ÙˆØ¨",e:"ğŸŒ…",g:"linear-gradient(160deg,#100600,#1e0c00)"},
  {l:"Ø¨Ø­Ø±",e:"ğŸŒŠ",g:"linear-gradient(160deg,#020a12,#051828)"},
  {l:"Ø°Ù‡Ø¨ÙŠ",e:"âœ¨",g:"linear-gradient(160deg,#0c0800,#1c1200)"},
  {l:"Ø¯Ø§ÙƒÙ†",e:"â¬›",g:"linear-gradient(160deg,#060606,#0c0c0c)"},
];



/* â•â•â•â•â•â•â• STATE â•â•â•â•â•â•â• */
let S={
  sheikh:null, surah:SURAHS[0], vFrom:1, vTo:7, activeV:0,
  bg:0, font:'scheherazade', size:26, color:'#ffffff',
  pos:'center', fx:{moon:true,stars:true,glow:true,trans:true},
  playing:false
};

const audio=document.getElementById('audio');
const arN=n=>String(n).replace(/\d/g,d=>'Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©'[d]);
const fmt=s=>!s||isNaN(s)?'0:00':`${Math.floor(s/60)}:${String(Math.floor(s%60)).padStart(2,'0')}`;
const gV=n=>VERSES[n]||VERSES[1];

let toastT;
function toast$(m){const t=document.getElementById('toast');t.textContent=m;t.classList.add('show');clearTimeout(toastT);toastT=setTimeout(()=>t.classList.remove('show'),3000);}
function setStatus(m,c='#6e8878'){const b=document.getElementById('statusBar');b.textContent=m;b.style.color=c;}

/* â•â•â•â•â•â•â• AUDIO â•â•â•â•â•â•â• */
// globalAyah no longer needed (using surah audio)

// Ù…ØµØ§Ø¯Ø± Ù…ØªØ¹Ø¯Ø¯Ø© Ù„Ù„ÙÙˆÙ„Ø¨Ø§Ùƒ
function getAudioUrl(sheikh, sn){
  // mp3quran.net: Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù = Ø±Ù‚Ù… Ø§Ù„Ø³ÙˆØ±Ø© Ø¨Ù€ 3 Ø£Ø±Ù‚Ø§Ù…
  const pad = String(sn).padStart(3,'0');
  return `${sheikh.server}${pad}.mp3`;
}

/* â•â•â•â•â•â•â• AUDIO ENGINE (race-condition safe) â•â•â•â•â•â•â• */
let pendingPlay = false;   // Ù‡Ù„ ÙÙŠ Ø·Ù„Ø¨ play() ÙŠÙ†ØªØ¸Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„ØŸ
let loadedSrc   = '';      // Ø§Ù„Ù€ URL Ø§Ù„Ù„ÙŠ Ø§ØªØ­Ù…Ù„ Ø¢Ø®Ø± Ù…Ø±Ø©

function loadAudio(sheikh, sn, an, autoPlay=false){
  if(!sheikh) return;
  const url = getAudioUrl(sheikh, sn);
  if(url === loadedSrc && audio.readyState >= 2){
    // Ù†ÙØ³ Ø§Ù„Ù…Ù„Ù Ù…ØªØ­Ù…Ù‘Ù„ Ø¨Ø§Ù„ÙØ¹Ù„ â€” Ø§Ø´ØºÙ‘Ù„ Ù…Ø¨Ø§Ø´Ø±Ø©
    if(autoPlay) doPlay();
    return;
  }
  loadedSrc   = url;
  pendingPlay = autoPlay;

  // ÙˆÙ‚Ù‘Ù Ø£ÙŠ ØªØ´ØºÙŠÙ„ Ø­Ø§Ù„ÙŠ Ø¨Ø£Ù…Ø§Ù†
  if(!audio.paused){
    audio.pause();
    audio.currentTime = 0;
  }

  setStatus('âŸ³ Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...','#e4b55a');
  setNpSub((sheikh?sheikh.name:'') + ' Â· âŸ³ Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...');

  audio.src = url;   // src Ù…Ø¨Ø§Ø´Ø± Ø£Ø³Ø±Ø¹ ÙˆØ£Ù…ÙˆÙ‘Ù† Ù…Ù† Ø¹Ù†Ø§ØµØ± source
  audio.load();
}

function doPlay(){
  const p = audio.play();
  if(p && p.catch) p.catch(err=>{
    // Ø®Ø·Ø£ Ù…Ø´Ù‡ÙˆØ± â€” ignore it Ù„Ùˆ Ø¨ÙŠØªØ­Ù…Ù‘Ù„
    if(err.name === 'AbortError') return;
    setStatus('âŒ '+err.message,'#f47c7c');
    toast$('âŒ ØªØ¹Ø°Ù‘Ø± Ø§Ù„ØªØ´ØºÙŠÙ„');
  });
}

/* â”€â”€ Ø£Ø­Ø¯Ø§Ø« Ø§Ù„ØµÙˆØª â”€â”€ */
audio.addEventListener('canplay', ()=>{
  setStatus('â— Ø¬Ø§Ù‡Ø²','#5ec285');
  setNpSub((S.sheikh?S.sheikh.name:'') + ' Â· Ø¬Ø§Ù‡Ø² âœ…');
  document.getElementById('npSub').style.color='#5ec285';
  if(pendingPlay){ pendingPlay=false; doPlay(); }
});

audio.addEventListener('playing', ()=>{
  S.playing=true;
  document.getElementById('mainBtn').textContent='â¸';
  document.getElementById('mainBtn').style.background='linear-gradient(135deg,#5c2424,#a03030)';
  document.getElementById('playDot').style.display='block';
  setStatus('â–¶ ÙŠÙØ´ØºÙÙ‘Ù„','#5ec285');
});

audio.addEventListener('pause', ()=>{
  S.playing=false;
  document.getElementById('mainBtn').textContent='â–¶';
  document.getElementById('mainBtn').style.background='linear-gradient(135deg,#245c38,#3ea066)';
  document.getElementById('playDot').style.display='none';
});

audio.addEventListener('ended', ()=>{
  S.playing=false;
  document.getElementById('mainBtn').textContent='â–¶';
  document.getElementById('mainBtn').style.background='linear-gradient(135deg,#245c38,#3ea066)';
  document.getElementById('playDot').style.display='none';
  document.getElementById('pFill').style.width='0%';
  document.getElementById('pDot').style.left='0%';
  loadedSrc='';
});

audio.addEventListener('timeupdate', ()=>{
  const d=audio.duration||0, c=audio.currentTime, p=d?(c/d)*100:0;
  document.getElementById('pFill').style.width=p+'%';
  document.getElementById('pDot').style.left=p+'%';
  document.getElementById('tCur').textContent=fmt(c);
  document.getElementById('tDur').textContent=fmt(d);
});

audio.addEventListener('error', ()=>{
  if(audio.networkState===3){
    setStatus('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„','#f47c7c');
    setNpSub('âŒ ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª');
    document.getElementById('npSub').style.color='#f47c7c';
    S.playing=false; pendingPlay=false;
  }
});

audio.addEventListener('waiting', ()=>setStatus('âŸ³ Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...','#e4b55a'));
audio.addEventListener('stalled', ()=>setStatus('âŸ³ Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...','#e4b55a'));

function setNpSub(t){ document.getElementById('npSub').textContent=t; }

/* â”€â”€ ØªØ´ØºÙŠÙ„/Ø¥ÙŠÙ‚Ø§Ù â”€â”€ */
function togglePlay(){
  if(!S.sheikh){ toast$('âš  Ø§Ø®ØªØ± Ø´ÙŠØ®Ø§Ù‹ Ø£ÙˆÙ„Ø§Ù‹'); return; }
  if(S.playing){ audio.pause(); return; }
  const url=getAudioUrl(S.sheikh, S.surah.n);
  if(url===loadedSrc && audio.readyState>=2){
    doPlay();   // Ø§Ù„ØµÙˆØª Ø¬Ø§Ù‡Ø² â€” Ø§Ø´ØºÙ‘Ù„ ÙÙˆØ±Ø§Ù‹
  } else {
    loadAudio(S.sheikh, S.surah.n, S.vFrom+S.activeV, true); // Ø­Ù…Ù‘Ù„ Ø«Ù… Ø§Ø´ØºÙ‘Ù„
  }
}

function seekRel(d){ if(audio.duration) audio.currentTime=Math.max(0,Math.min(audio.duration,audio.currentTime+d)); }
function seekClick(e){ const r=e.currentTarget.getBoundingClientRect(); const ratio=Math.max(0,Math.min(1,(e.clientX-r.left)/r.width)); if(audio.duration) audio.currentTime=ratio*audio.duration; }

/* â•â•â•â•â•â•â• RENDER â•â•â•â•â•â•â• */
function renderShuyukh(){
  document.getElementById('shGrid').innerHTML=SHUYUKH.map((sh,i)=>`
    <div class="sh-card" id="sc${i}" onclick="pickSheikh(${i})">
      <div class="sh-flag">${sh.flag}</div>
      <div class="sh-name">${sh.name}</div>
      <div class="sh-country">${sh.country}</div>
    </div>`).join('');
}
function pickSheikh(i){
  S.sheikh=SHUYUKH[i];
  document.querySelectorAll('.sh-card').forEach((c,j)=>c.classList.toggle('on',j===i));
  document.getElementById('elSheikh').textContent='ØªÙ„Ø§ÙˆØ©: '+S.sheikh.name;
  document.getElementById('npSub').style.color='';
  toast$('âœ“ '+S.sheikh.name);
  loadedSrc=""; loadAudio(S.sheikh, S.surah.n, S.vFrom+S.activeV, false);
}

function renderSurahs(list=SURAHS){
  document.getElementById('surahList').innerHTML=list.map(sr=>`
    <div class="s-item ${S.surah.n===sr.n?'on':''}" onclick="pickSurah(${sr.n})">
      <div class="s-num">${sr.n}</div>
      <div class="s-ar">${sr.ar}</div>
      <div class="s-v">${sr.v}</div>
    </div>`).join('');
}
function filterSurahs(q){renderSurahs(q?SURAHS.filter(s=>s.ar.includes(q)||String(s.n).includes(q)):SURAHS);}
function pickSurah(n){
  S.surah=SURAHS.find(s=>s.n===n);
  S.vFrom=1;S.vTo=Math.min(7,S.surah.v);S.activeV=0;
  document.getElementById('vFrom').value=1;
  document.getElementById('vTo').value=S.vTo;
  renderSurahs();renderVerses();updateScreen();
  if(S.sheikh){ loadedSrc=""; loadAudio(S.sheikh, S.surah.n, 1, false); }
  toast$('âœ“ Ø³ÙˆØ±Ø© '+S.surah.ar);
}
function rangeChanged(){
  S.vFrom=Math.max(1,+document.getElementById('vFrom').value||1);
  S.vTo=Math.min(+document.getElementById('vTo').value||7,S.surah.v);
  S.activeV=0;renderVerses();updateScreen();
}

function renderVerses(){
  const vv=gV(S.surah.n),sl=vv.slice(Math.max(0,S.vFrom-1),S.vTo);
  document.getElementById('vList').innerHTML=sl.map((v,i)=>`
    <div class="v-item ${S.activeV===i?'on':''}" onclick="pickVerse(${i})">
      <div class="v-num">${arN(S.vFrom+i)}</div>
      <div><div class="v-ar">${v.ar}</div><div class="v-en">${v.en}</div></div>
    </div>`).join('');
}
function pickVerse(i){
  S.activeV=i;renderVerses();updateScreen();
  document.getElementById('npTitle').textContent=S.surah.ar+' â€” Ø¢ÙŠØ© '+arN(S.vFrom+i);
  if(S.sheikh){
    loadedSrc=""; loadAudio(S.sheikh, S.surah.n, S.vFrom+i, true);
  }else toast$('âš  Ø§Ø®ØªØ± Ø´ÙŠØ®Ø§Ù‹ Ø£ÙˆÙ„Ø§Ù‹');
}

function renderBGs(){
  document.getElementById('bgGrid').innerHTML=BGS.map((b,i)=>`
    <div class="bg-thumb ${S.bg===i?'on':''}" style="background:${b.g}" onclick="pickBg(${i})">
      ${b.e}<div class="bg-lbl">${b.l}</div>
    </div>`).join('');
}
function pickBg(i){
  S.bg=i;renderBGs();
  document.getElementById('screen').style.background=BGS[i].g;
  toast$('âœ“ '+BGS[i].l);
}

function updateScreen(){
  const vv=gV(S.surah.n),v=vv[Math.max(0,S.vFrom-1+S.activeV)]||vv[0];
  if(!v)return;
  document.getElementById('vAr').textContent=v.ar;
  document.getElementById('vRef').textContent=`ï´¿ ${S.surah.ar} : ${arN(S.vFrom+S.activeV)} ï´¾`;
  document.getElementById('vEn').textContent=v.en;
  document.getElementById('vEn').style.display=S.fx.trans?'block':'none';
  const ff=S.font==='amiri'?"'Amiri',serif":S.font==='cairo'?"'Cairo',sans-serif":"'Scheherazade New',serif";
  document.getElementById('vAr').style.cssText=`font-family:${ff};font-size:${S.size}px;color:${S.color};line-height:2.1;text-shadow:0 2px 14px rgba(0,0,0,.95);direction:rtl`;
  const va=document.getElementById('verseArea');
  if(S.pos==='top'){va.style.top='15%';va.style.bottom='auto';va.style.transform='none';}
  else if(S.pos==='bottom'){va.style.top='auto';va.style.bottom='14%';va.style.transform='none';}
  else{va.style.top='50%';va.style.bottom='auto';va.style.transform='translateY(-50%)';}
  document.getElementById('npTitle').textContent=S.surah.ar+' â€” Ø¢ÙŠØ© '+arN(S.vFrom+S.activeV);
}

/* â•â•â•â•â•â•â• CONTROLS â•â•â•â•â•â•â• */
function switchTab(t){
  ['sheikh','surah','bg'].forEach((id,i)=>{
    document.getElementById('tab-'+id).style.display=id===t?'block':'none';
    document.querySelectorAll('.ttab')[i].classList.toggle('on',id===t);
  });
}
function setPos(btn,p){
  S.pos=p;document.querySelectorAll('.pos-btn').forEach(b=>b.classList.remove('on'));btn.classList.add('on');updateScreen();
}
function setFont(btn,f){
  S.font=f;document.querySelectorAll('.font-btn').forEach(b=>b.classList.remove('on'));btn.classList.add('on');updateScreen();
}
function setSize(v){
  S.size=+v;document.getElementById('fsLbl').textContent=v;document.getElementById('fsRange').value=v;
  document.querySelectorAll('.sz-btn').forEach(b=>b.classList.toggle('on',+b.textContent===+v));updateScreen();
}
function setColor(c,el){
  S.color=c;document.querySelectorAll('.clr-dot').forEach(d=>d.classList.remove('on'));el.classList.add('on');updateScreen();
}
function toggleFx(k){
  S.fx[k]=!S.fx[k];
  const on=S.fx[k];
  const sw=document.getElementById('sw-'+k);
  const sk=document.getElementById('sk-'+k);
  sw.style.background=on?'linear-gradient(135deg,#245c38,#3ea066)':'#18301e';
  sw.style.borderColor=on?'rgba(62,160,102,.4)':'rgba(255,255,255,.08)';
  sk.style.right=on?'3px':'20px';
  const els={moon:'elMoon',stars:'elStars',glow:'elGlow'};
  if(els[k])document.getElementById(els[k]).style.display=on?'block':'none';
  if(k==='trans')document.getElementById('vEn').style.display=on?'block':'none';
}

function startExport(){
  document.getElementById('expBox').style.display='block';
  let p=0;
  const iv=setInterval(()=>{
    p+=Math.random()*10+3;
    if(p>=100){p=100;clearInterval(iv);setTimeout(()=>{document.getElementById('expBox').style.display='none';toast$('âœ… ØªÙ… Ø§Ù„ØªØµØ¯ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­!');},500);}
    document.getElementById('expFill').style.width=p+'%';
    document.getElementById('expPct').textContent=Math.round(p)+'%';
  },180);
}

/* â•â•â•â•â•â•â• INIT â•â•â•â•â•â•â• */
renderShuyukh();renderSurahs();renderBGs();renderVerses();updateScreen();
</script>
</body>
</html>
